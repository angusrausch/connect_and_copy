# Wireguard Copier

## üöÄ Copy Home with Ease

**Wireguard Copier** is your lightweight solution for effortlessly backing up files to a server behind a firewall, leveraging the power of **Wireguard VPN** and **Rsync**. Say goodbye to full VPN connections slowing down your entire network!

---

## ‚ú® Background

### The Problem

When I'm on the go, backing up files to my home server shouldn't mean crippling my laptop's network speed by connecting the entire device to a VPN. The overhead is simply too much.

### My Solution

I envisioned a sleek, isolated environment‚Äîa **Docker Container**‚Äîthat could establish a secure connection to my home VPN and efficiently copy files without impacting other network activities. This led to the creation of the Wireguard Copier image. It's designed for universal application, allowing you to easily configure the VPN endpoint and target directories. Currently, it's tailored for use with **SMB** file shares.

---

## üõ†Ô∏è Installation

Get started by installing Docker on your system:

* **Docker Installation Guide:** [https://docs.docker.com/engine/install/](https://docs.docker.com/engine/install/)

This image will soon be available on Docker Hub for even easier deployment.

---

## üèóÔ∏è Building the Image

If you're cloning this repository directly, you'll need to build the Docker image:

```bash
docker build -t "connect_and_copy" .
```

---

## üöÄ Usage

Wireguard Copier offers two convenient ways to run:

### Using `run.sh`

For a streamlined experience, set up your [environment variables](#-environment-variables) in a `.env` file, then simply run:

```bash
./run.sh
```

### Direct Docker Run

For more granular control, execute the `docker run` command directly. **Remember to replace the placeholder variables with your actual values.**

```bash
docker run \
    --rm -it \
    --network bridge \
    --privileged \
    -v $ABSOLUTE_FOLDER_PATH:/tmp/copy_from/$FOLDER_NAME \
    -v $ABSOLUTE_CONFIG_PATH:/tmp/config/wg0.conf \
    -e REMOTE_HOST=$REMOTE_HOST \
    -e REMOTE_SHARE=$REMOTE_SHARE \
    -e REMOTE_LOCATION=$REMOTE_LOCATION \
    -e USERNAME=$USERNAME \
    -e PASSWORD=$PASSWORD \
    connect_and_copy
```

---

## ‚öôÔ∏è Environment Variables

To use the `run.sh` script, create a `.env` file in the root directory with the following format. Ensure all values are correctly populated:

```
# Wireguard configuration file: Generally generated by your VPN server
CONFIG_FILE=

# Directory on your local machine to copy files from
COPY_FOLDER=

# Remote SMB server information
REMOTE_HOST=
REMOTE_SHARE=
REMOTE_LOCATION= # Location on the remote SMB share (e.g., /backups/my_laptop)

# SMB account details for authentication
USERNAME=
PASSWORD=
```

---

## üîí Security Considerations

‚ö†Ô∏è **Important:** This Docker container requires `--privileged` access.

This elevated privilege is necessary to enable the Wireguard VPN connection and to mount the SMB network drive within the container. Please use this solution at your own discretion and understand the implications of running privileged containers.

---

## ü§ù Contributing

We welcome contributions! If you have suggestions for improvements, new features, or bug fixes, please feel free to:

1.  **Fork** the repository.
2.  **Create a new branch** (`git checkout -b feature/your-feature-name`).
3.  **Make your changes**.
4.  **Commit your changes** (`git commit -m 'Add new feature'`).
5.  **Push to the branch** (`git push origin feature/your-feature-name`).
6.  **Open a Pull Request**.

---

## ‚ùì Support

If you encounter any issues or have questions, please open an issue on the GitHub repository. I'll do our best to assist you!